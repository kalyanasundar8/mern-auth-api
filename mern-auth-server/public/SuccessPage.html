<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1 class="status">Verifying your email</h1>
  </body>
  <script>
    const url = new URLSearchParams(window.location.search);
    const token = url.get("token");

    if (!token) {
      status.innerText = "Invalid verification link";
    } else {
      verifyToken(token);
    }

    const status = document.getElementsByClassName("status");

    // Verify token using API
    async function verifyToken(token) {
      try {
        const response = await fetch(
          `http://localhost:4003/api/user/verify-email?token=${token}`,
          {
            method: "GET",
          }
        );
        const data = await response.json();

        if (response.ok) {
          status.innerText = "Email verified successfully";
        } else {
          status.innerText = data.message || "Verification failed";
        }
      } catch (error) {
        status.innerText = "Something went wrong!, please try again";
        console.log(`Email verification error: ${error}`);
      }
    }
  </script>
</html>
